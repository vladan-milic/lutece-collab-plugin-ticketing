<#include "/skin/plugins/asynchronousupload/upload_commons.html" />
<script src="js/bootstrap-datepicker.js"></script>
<script src="js/locales/bootstrap-datepicker.fr.js" charset="utf-8"></script>
<div class="row" >
    <div class="col-sm-12">
    <form class="form-horizontal" role="form" method="post" action="jsp/site/Portal.jsp?page=ticket" enctype="multipart/form-data">
        <fieldset>
            <legend>#i18n{ticketing.xpage.create_ticket.title}</legend>

            <@messages errors=errors />
            
			<input name="page" value="ticket" type="hidden">
			<input name="action" value="recapTicket" type="hidden">
            <input type="hidden" id="id" name="id"/>  
            <input type="hidden" id="guid" name="guid" value="${ticket.guid!}"/>
            <div class="form-group">
                <label class="col-sm-3 control-label" for="id_user_title" >#i18n{ticketing.xpage.create_ticket.labelIdUserTitle}&#8239;*&#8239;:</label>
                <div class="col-sm-9">
                    <@comboWithParams name="id_user_title" default_value="${ticket.idUserTitle!''}"  additionalParameters="class=\"form-control\""  items=user_titles_list />
                    <span class="help-block">#i18n{ticketing.xpage.create_ticket.labelIdUserTitle.help}</span>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label" for="lastname" >#i18n{ticketing.xpage.create_ticket.labelLastname}&#8239;*&#8239;:</label>
                <div class="col-sm-9">
                    <input class="form-control" type="text" id="lastname" name="lastname" value="${ticket.lastname!''}"  maxlength="50" />
                    <span class="help-block">#i18n{ticketing.xpage.create_ticket.labelLastname.help}</span>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label" for="firstname" >#i18n{ticketing.xpage.create_ticket.labelFirstname}&#8239;*&#8239;:</label>
                <div class="col-sm-9">
                    <input class="form-control" type="text" id="firstname" name="firstname" value="${ticket.firstname!}"  maxlength="50" />
                    <span class="help-block">#i18n{ticketing.xpage.create_ticket.labelFirstname.help}</span>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label" for="email" >#i18n{ticketing.xpage.create_ticket.labelEmail}&#8239;*&#8239;:</label>
                <div class="col-sm-9">
                    <input class="form-control" type="text" id="email" name="email" value="${ticket.email!''}"  maxlength="255" />
                    <span class="help-block">#i18n{ticketing.xpage.create_ticket.labelEmail.help}</span>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label" for="fixed_phone_number" >#i18n{ticketing.xpage.create_ticket.labelFixedPhoneNumber}&#8239;:</label>
                <div class="col-sm-9">
                    <input class="form-control input-phone" type="text" id="fixed_phone_number" name="fixed_phone_number" value="${ticket.fixedPhoneNumber!''}"  maxlength="10" />
                    <span class="help-block">#i18n{ticketing.xpage.create_ticket.labelPhoneNumber.help}</span>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label" for="mobile_phone_number" >#i18n{ticketing.xpage.create_ticket.labelMobilePhoneNumber}&#8239;:</label>
                <div class="col-sm-9">
                    <input class="form-control input-phone" type="text" id="mobile_phone_number" name="mobile_phone_number" value="${ticket.mobilePhoneNumber!''}"  maxlength="10" />
                    <span class="help-block">#i18n{ticketing.xpage.create_ticket.labelPhoneNumber.help}</span>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label" for="id_ticket_type" >#i18n{ticketing.xpage.create_ticket.labelTicketType}&#8239;*&#8239;:</label>
                <div class="col-sm-9">
                    <@comboWithParams name="id_ticket_type" default_value="${ticket.idTicketType!''}"  additionalParameters="class=\"form-control\""  items=ticket_types_list />
                    <span class="help-block">#i18n{ticketing.xpage.create_ticket.labelIdTicketType.help}</span>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label" for="id_ticket_domain" >#i18n{ticketing.xpage.create_ticket.labelTicketDomain}&#8239;*&#8239;:</label>
                <div class="col-sm-9">
                    <@comboWithParams name="id_ticket_domain" default_value="${ticket.idTicketDomain!''}"  additionalParameters="class=\"form-control\""  items=ticket_domains_list />
                    <span class="help-block">#i18n{ticketing.xpage.create_ticket.labelIdTicketDomain.help}</span>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label" for="id_ticket_category" >#i18n{ticketing.xpage.create_ticket.labelTicketCategory}&#8239;*&#8239;:</label>
                <div class="col-sm-9">
                     <@comboWithParams name="id_ticket_category" default_value="${ticket.ticketCategory.id!''}"  additionalParameters="class=\"form-control\""  items=ticket_categories_list />
                    <span class="help-block" id="help_message_category"></span>
                </div>
            </div>
            <div class="form-group">
                <div class="col-xs-12 col-sm-9 col-md-6 col-lg-6 col-sm-offset-3 col-md-offset-md-3 col-lg-offset-3">
                    <@comboWithParams name="id_ticket_precision" default_value="${ticket.ticketCategory.precision!''}"  additionalParameters="class=\"form-control\""  items=ticket_precisions_list />
                    <span class="help-block" id="help_message_precision"></span>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label" for="id_contact_mode" >#i18n{ticketing.xpage.create_ticket.labelContactMode}&#8239;*&#8239;:</label>
                <div class="col-sm-9">
                    <@comboWithParams name="id_contact_mode" default_value="${ticket.idContactMode!''}"  additionalParameters="class=\"form-control\""  items=contact_modes_list />
                    <span class="help-block">#i18n{ticketing.xpage.create_ticket.labelContactMode.help}</span>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label" for="ticket_comment" >#i18n{ticketing.xpage.create_ticket.labelTicketComment}&#8239;:</label>
                <div class="col-sm-9">
                    <textarea class="ticketing form-control" id="ticket_comment" name="ticket_comment" >${ticket.ticketComment!''} </textarea>
                    <span class="help-block">#i18n{ticketing.xpage.create_ticket.labelTicketComment.help}</span>
                </div>
            </div>
            <div class="form-group" id="generic_attributes">          
            </div>
            <div class="form-group">
                <div class="col-sm-offset-3 col-sm-9">
                    <button name="action_recapTicket" class="btn btn-primary" type="submit">
                        #i18n{ticketing.xpage.create_ticket.labelButtonCreate}
                    </button>
               </div>
            </div>
        </fieldset>
    </form>
    </div>
</div>


<script src="js/plugins/ticketing/ticket_tree.js"></script>
<script language="javascript"> 
    var category_id = ${ticket.ticketCategory.id!''};
    var is_front = true ;
    var is_generic_attributes_managed = true;
    $(document).ready(function() {
        lutece_ticket_tree("#id_ticket_type", "#id_ticket_domain", "#id_ticket_category", "#id_ticket_precision", category_id, is_front, is_generic_attributes_managed);
    });

    $(document).ready(function() {
        $('.input-phone').change(function() {
            var result = $(this).val().replace(/\s/g,"");
            $(this).val(result);
        });
    });
</script>
<@addRequiredJsFiles />
<script type="text/javascript" src="jsp/site/plugins/asynchronousupload/GetMainUploadJs.jsp?handler=ticketAsynchronousUploadHandler" ></script>
