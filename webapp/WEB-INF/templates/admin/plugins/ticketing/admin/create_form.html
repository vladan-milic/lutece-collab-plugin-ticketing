<#include "/admin/util/editor/editor.html" />
<#global form=form>
<#macro formEntryLine entryType label="">
<#assign entry = form.getEntry(entryType)>
<#if label = "">
	<#assign label = i18n('ticketing.xpage.create_ticket.'+entryType+'.label')>
</#if>
<div class="form-group">
	<div class="row">
		<div class="col-xs-12 col-sm-3">
			<label for="id_user_title" >${label}</label>
		</div>
		<div class="col-xs-12 col-sm-3">
			<input type="checkbox" name="formEntries.${entryType}.hidden" value="${entry.hidden?then('1','0')}">
		</div>
		<div class="col-xs-12 col-sm-3">
			<input type="checkbox" name="formEntries.${entryType}.mandatory" value="${entry.mandatory?then('1','0')}">
		</div>
	</div>
</div>
</#macro>

<div class="row">
   <div class="col-xs-12 col-sm-12 col-md-12">
      <div class="box box-solid box-primary">
         <div class="box-header">
            <h3 class="box-title">#i18n{ticketing.create_form.title}</h3>
         </div>
         <div class="box-body">
	         <div class="col-md-8">
	            <form class="form-horizontal" method="post" name="create_form" action="jsp/admin/plugins/ticketing/admin/ManageForms.jsp">
	               <@messages errors=errors />
	               <input type="hidden" id="id" name="id"/>
	         <@fieldInputText i18nLabelKey="ticketing.manage_viewing.labelTitle" inputName="title" mandatory=true value="${form.title!''}" i18nHelpBlockKey="ticketing.manage_viewing.labelTitle.help" /> 
    <div class="form-group"> 
      <label class="control-label col-xs-12 col-sm-3" for="confirmation_msg">#i18n{ticketing.create_contactmode.labelConfirmationMsg} : </label> 
        <div class="col-xs-12 col-sm-9"> 
          <textarea name="message" id="message" class="ticketing richtext form-control">${form.message!''}</textarea> 
          <span class="help-block">#i18n{ticketing.manage_viewing.labelMessage.help}</span>
        </div> 
    </div>   
    <@fieldInputText i18nLabelKey="ticketing.manage_viewing.labelValidationButton" inputName="buttonLabel" value="${form.buttonLabel!''}" i18nHelpBlockKey="ticketing.manage_viewing.labelValidationButton.help" /> 
				<div class="form-group">
					<label class="col-xs-12 col-sm-12 col-md-3 col-lg-3 control-label" for="mandatory">#i18n{ticketing.create_form.labelConnection}</label>
			        <div class="col-xs-12 col-sm-12 col-md-9 col-lg-9">
						<div class="checkbox">
							<label>
								<input type="checkbox" id="connection" name="connection" value="1" >
							</label>
						</div>
					</div>
				</div>
				
      		<#assign entryUserTitle = form.getEntry(formEntryType.userTitle)>
      		<#assign entryLastName = form.getEntry(formEntryType.lastName)>
      		<#assign entryFirstName = form.getEntry(formEntryType.firstName)>
      		<#assign entryEmail = form.getEntry(formEntryType.email)>
      		<#assign entryPhones = form.getEntry(formEntryType.phoneNumbers)>
      		<#assign entryContactMode = form.getEntry(formEntryType.contactMode)>
      		<#assign entryComment = form.getEntry(formEntryType.comment)>
      		
      		<#list formEntryType.entryTypes() as entryType>
				<@formEntryLine entryType=entryType/>
            </#list>
            
            <#list categories_depths as depth>
            <#assign entryCategory = form.getEntry(formEntryType.category + depth.depthNumber)>
             <div class="form-group >
                <label for="id_category_${depth.depthNumber}">${depth.label} </label>
                <div class="select">
                    <@comboWithParams name="id_category_${depth.depthNumber}" default_value="" additionalParameters=" id=\"id_category_${depth.depthNumber}\" depth=\"${depth.depthNumber}\" class=\"select-control\" " items=[] />
                </div>
                <span class="help-block" id="help_message_${depth.depthNumber}"></span>
	   		</div>
            </#list>
           
                                               		
	               <@actionButtons button1Name="action_createForm" button2Name="view_manageForms"/>
	            </form>
            </div>
         </div>
      </div>
   </div>
</div>
<@initEditor />
<script type="text/javascript">
	$("#title").change(function(){
		$("#formPreview").html($("#title").val());
	});
	$("#labelColor").change(function(){
		$("#formPreview").css("color", $("#labelColor").val());
	});
	$("#backgroundColor").change(function(){
		$("#formPreview").css("background-color", $("#backgroundColor").val());
	});
</script>