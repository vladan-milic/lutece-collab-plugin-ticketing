<#include "modify_ticketform_tabs.html" />
<@tabsWrapper>
	<@tabs tab="entries" ticketform=ticketform />
			<h3 class="sr-only">#i18n{ticketing.modify_ticketform.pageTitle}</h3>
			<form method="get" class="form-inline pull-right" action="jsp/admin/plugins/ticketing/admin/ManageTicketFormEntries.jsp">
				<input type="hidden" value="getCreateEntry" name="view">
				<input type="hidden" name="id_form" value="${ticketform.idForm}">
				<label for="id_type">#i18n{ticketing.modify_ticketform.labelInsertEntry} :&#160;&#160;</label>
				<div class="input-group">
					<@comboWithParams name="id_type" items=entry_type_list default_value="-1" additionalParameters="class='form-control input-sm'" />
					<span class="input-group-btn">
				<button type="submit" class="btn btn-primary btn-sm" title="#i18n{ticketing.modify_ticketform.buttonInsertEntry}">
					<i class="fa fa-plus"></i>
				</button>
				</span>
				</div>
			</form>
			<form method="post" action="jsp/admin/plugins/ticketing/admin/ManageTicketFormEntries.jsp">
			<input type="hidden" name="action" value="doChangeOrderEntry">
			<input type="hidden" name="id_form" value="${ticketform.idForm}">
			<#if entry_group_list?has_content>
				<div>
					<!-- List all entry of type group  -->
					<@comboWithParams name="id_entry_group" items=entry_group_list  default_value="" additionalParameters=" class=\"form-control\" " />
					<button type="submit" class="btn btn-primary btn-sm" title="#i18n{ticketing.modify_ticketform.move}" name="add_to_group" value="#i18n{ticketing.modify_ticketform.moveAll}">
						<i class="fa fa-resize-vertical"></i>
					</button>
				</div>
			</#if>
			<table class="table table-striped table-hover">
				<thead>
					<tr>
						<th><input type="checkbox" name="selectAll" id="selectAll" value="selectAll" title="#i18n{ticketing.modify_ticketform.selectAll}"></th>
						<th>#i18n{ticketing.createEntry.manageField.rowTitle} #i18n{ticketing.modifyField.manageConditionalQuestion.rowType}</th>
						<th><i class="fa fa-question-circle" title="#i18n{ticketing.createEntry.manageField.rowConditionalQuestion}"></i></th>
						<th>#i18n{ticketing.createEntry.manageField.rowOrder}</th>
						<th>#i18n{ticketing.createEntry.manageField.rowActions}</th>
					</tr>
				</thead>
				<tbody>
					<#list entry_list as entry>
						<#if entry.entryType.group>
							<#assign lastGroup=entry>
						</#if>
						<tr>
							<td>
								<!--  add checkbox if entry isn't a group -->
								<#if !entry.entryType.group>
									<input type="checkbox" class="chbx" name="entry_id_move" value="${entry.idEntry!}" title="#i18n{ticketing.modify_ticketform.select}">
								</#if>
							</td>
							<td>
								<#if entry.entryType.group>
									${entry.title}
								<#elseif entry.parent?exists>
									<#if entry.entryType.comment>
										<blockquote>${entry.comment}</blockquote>
									<#else>
										<blockquote>${entry.title}</blockquote>
									</#if>
								<#elseif entry.entryType.myLuteceUser>
									${entry.title}
								<#else>
									<#if entry.entryType.comment>
										${entry.comment}
									<#else>
										${entry.title}
								</#if>
								</#if>
								<#if !entry.entryType.group>
									<p><span class="badge">${entry.entryType.title}</span></p>
								</#if>
							</td>
							<td>
									<#if entry.numberConditionalQuestion!=0>
										${entry.numberConditionalQuestion}
									</#if>
								</td>
								<!--  Change the order of the attribute -->
								<#if entry.parent?exists>
									<td class="col-xs-12 col-sm-1">
										<blockquote>
											<div class="input-group">
												<@comboOrders name="order_id_${entry.idEntry}" default_value=entry.position idParent=entry.parent.idEntry />
												<div class="input-group-btn">
													<button class="btn btn-primary" type="submit" name="id_entry" title="#i18n{ticketing.modify_ticketform.move}" value="${entry.idEntry}">
														<i class="fa fa-check"></i>
													</button>
												</div>
											</div>
										</blockquote>
									</td>
								<#else>
									<td class="col-xs-12 col-sm-1">
										<div class="input-group">
											<@comboOrders name="order_id_${entry.idEntry}" default_value=entry.position idParent=0 />
											<div class="input-group-btn">
												<button class="btn btn-primary" type="submit" name="id_entry" title="#i18n{ticketing.modify_ticketform.move}" value="${entry.idEntry}">
													<i class="fa fa-check"></i>
												</button>
											</div>
										</div>
									</td>
								</#if>
								<td>
									<#if !entry.entryType.myLuteceUser>
										<a href="jsp/admin/plugins/ticketing/admin/ManageTicketFormEntries.jsp?view=getModifyEntry&id_entry=${entry.idEntry}" class="btn btn-primary">
											<i class="fa fa-pencil"></i>
										</a>
									</#if>
									<#if entry.parent?exists>
										<a href="jsp/admin/plugins/ticketing/admin/ManageTicketFormEntries.jsp?action=doMoveOutEntry&id_entry=${entry.idEntry}#list" title="#i18n{ticketing.modifyField.manageConditionalQuestion.titleGoOut}" class="btn btn-primary">
											<i class="fa fa-chevron-right"></i>
										</a>
									</#if>
									<#if !entry.entryType.group && !entry.entryType.myLuteceUser>
										<a href="jsp/admin/plugins/ticketing/admin/ManageTicketFormEntries.jsp?action=doCopyEntry&id_entry=${entry.idEntry}#list" title="#i18n{ticketing.createEntry.manageField.titleCopy}" class="btn btn-primary">
											<i class="fa fa-copy"></i>
										</a>
									</#if>
									<a href="jsp/admin/plugins/ticketing/admin/ManageTicketFormEntries.jsp?view=confirmRemoveEntry&id_entry=${entry.idEntry}#list" title="#i18n{ticketing.modifyField.manageConditionalQuestion.titleDelete}" class="btn btn-danger">
										<i class="fa fa-trash"></i>
									</a>
								</td>
							</tr>
						</#list>
					</tbody>
				</table>
			</form>
</@tabsWrapper>
<script>
	$( function() {
		$("#selectAll").change( function() {
	    if ( $(this).prop("checked") ){
				// check all
	      $(".chbx").prop( "checked", "checked");
			} else {
	      // uncheck all
	      $(".chbx").prop( "checked", "");
			}
	  });
	});
</script>
